// var imagePath = '../../../../../../Users/gabrielbach/Desktop/Salemoche/Freelance/Possa/InDesign_Scripting/Test/Test_Daten/Probesatz/Bilder/180319/'
var imagePath = './img/'

var data = 

[
    // {
    //   "Profil_": "DS",
    //   "Position_": "A",
    //   "Datum_": "26_03_2019",
    //   "Uhrzeit_": "16:18",
    //   "Thema_": "Faschismus\nRente\nSS-Soldaten\nZentralrat\nJuden\nDeutschland",
    //   "GesinnungX_": "Mitte",
    //   "GesinnungY_": "Mitte",
    //   "Verl�sslichkeit_": "Komplex",
    //   "Art_": "Zeitung",
    //   "Aufbau_": "Post-Artikel",
    //   "Medium_": "Text-Bild",
    //   "Bodytext_": "*pn*NZZ Neue Z�rcher Zeitung*/pn*\n\n*pd*26-03-19*/pd*\n\n*pb*Manche Nazi-Kollaborateure bekommen monatlich eine Zusatzrente im dreistelligen Bereich aus Deutschland �berwiesen. Insgesamt haben rund 2000 im Ausland lebende Menschen Anspruch auf diese Leistungen.\nDer Zentralrat der Juden will das nicht hinnehmen.*/pb*\n\n*an*Neue Z�rcher Zeitung*/an*\n\n*ad*26-03-19*/ad*\n\n*aa*Jonas Hermann*/aa*\n\n*at*Rente f�r ehemalige SS-Soldaten: Zentralrat der Juden spricht von �unertr�glichem Zustand�*/at*\n\n*al*Der deutsche Staat unterst�tzt im Ausland lebende Nazi-Kollaborateure mit monatlichen Zahlungen, falls sie im Krieg verwundet wurden. Zentralratspr�sident Schuster fordert nun, die Rentenanspr�che zu pr�fen.*/al*\n\n*ab*Manche Nazi-Kollaborateure bekommen monatlich eine Zusatzrente im dreistelligen Bereich aus Deutschland �berwiesen. Insgesamt haben rund 2000 im Ausland lebende Menschen Anspruch auf Leistungen nach dem sogenannten Bundesversorgungsgesetz. Es wurde im Jahr 1950 verabschiedet, um Kriegsgesch�digte zu unterst�tzen. Dabei kann es sich um Zivilisten handeln, aber auch um ehemalige Wehrmachtssoldaten und Angeh�rige der Waffen-SS. Deren Verb�nde waren im Zweiten Weltkrieg als eine Art Elitetruppe der Wehrmacht im Einsatz. Die Waffen-SS ist f�r viele Greueltaten verantwortlich, ausserdem war sie am Holocaust beteiligt. Kurz nach Kriegsende wurde sie in Deutschland verboten.*/ab*\n*ab*W�hrend des Krieges schlossen sich auch Ausl�nder der SS an. In von Deutschland besetzten L�ndern, wie Belgien oder Lettland, k�mpften sie als Freiwillige in der Waffen-SS. Der Historiker Martin G�llnitz sagte der Deutschen Welle, auch den ausl�ndischen SS-Mitgliedern h�tten die Nazis eine Rentenversicherung garantiert. Mehrere deutsche Medien berichteten, die bis heute gezahlte Rente gehe auf einen �F�hrererlass� von Adolf Hitler zur�ck. Das f�r die Renten zust�ndige Arbeitsministerium dementiert dies. Der NZZ sagte eine Sprecherin: ��F�hrererlasse� haben f�r das Bundesversorgungsgesetz �berhaupt keine Bedeutung.� Laut der Sprecherin werden die Renten nicht f�r den Dienst in der Wehrmacht oder der Waffen-SS an sich gezahlt. Anspruch darauf h�tten nur Menschen, die w�hrend dieses Dienstes verwundet wurden. Im M�rz habe das Arbeitsministerium an 2000 im Ausland lebende Berechtigte rund 778�000 Euro �berwiesen.*/ab*\n\n*au*49 Empf�nger in der Schweiz*/au*\n*ab*In der Schweiz beziehen offenbar 49 Menschen diese Rente, in Belgien soll es sich um 18 Personen handeln. Keiner der belgischen Empf�nger ist laut dem Arbeitsministerium bei der Waffen-SS gewesen. Der Historiker Alvin De Coninck bezweifelt dies und wird von drei Abgeordneten des belgischen Parlaments unterst�tzt. Bereits vor drei Jahren forderten sie die deutschen Beh�rden auf, die Namen der Rentenempf�nger herauszugeben. Auch deshalb, weil diese die Betr�ge wohl steuerfrei beziehen.*/ab*\n*ab*Die Namen sind der deutschen Botschaft in Belgien angeblich bekannt, sie gibt diese aber nicht weiter und kann sich dabei auf ein�Gutachten der Wissenschaftlichen Dienste des Bundestags�st�tzen. Darin heisst es, man d�rfe allein schon aus Datenschutzgr�nden keine Informationen �ber Rentenempf�nger herausgeben. Ohnehin existiere keine vollst�ndige �bersicht aller Mitglieder der Waffen-SS, weil die Nazis kurz vor Kriegsende zahlreiche Dokumente �ber SS-Angeh�rige vernichtet h�tten.*/ab*\n\n*au*�Unertr�glicher Zustand�*/au*\n*ab*Der Zentralrat der Juden will das nicht hinnehmen. Dessen Pr�sident Josef Schuster sprach von einem �unertr�glichen Zustand�. Die Beh�rden m�ssten die Rentenempf�nger �berpr�fen und Konsequenzen ziehen, sagte er der �Neuen Osnabr�cker Zeitung�. Laut der Zeitung bekommen die Rentenempf�nger im Schnitt 330 Euro pro Monat ausbezahlt. Auch Kurkosten w�rden �bernommen. Im Jahr 1997 regte sich im Bundestag Widerstand gegen diese Praxis. Die Parlamentarier beschlossen, keine Rente an Menschen zu �berweisen, die gegen �die Grunds�tze der Menschlichkeit oder Rechtsstaatlichkeit� verstossen haben.*/ab*\n*ab*Die Auswirkungen waren �berschaubar, denn die reine Mitgliedschaft in der SS gilt nicht als Ausschlusskriterium. Laut dem Arbeitsministerium wurden dennoch in 99 F�llen die Renten gestrichen. Angestossen hatte die Gesetzes�nderung der ehemalige Gr�nen-Bundestagsabgeordnete Volker Beck. Heute kritisiert er, das Arbeitsministerium k�mmere sich zu wenig darum, das Gesetz umzusetzen. Somit werden Menschen, die an den Verbrechen der Nazis beteiligt waren, auch weiterhin Geld aus Deutschland bekommen. Allerdings schrumpft das Problem von Monat zu Monat. Die Rentner sind hochbetagt. Allein von Februar auf M�rz starben 33 von ihnen.*/ab*\n\n\n\n\n",
    //   "LinkText_": "https://www.nzz.ch/international/deutschland/warum-zahlt-deutschland-ss-soldaten-rente-ld.1470083?fbclid=IwAR0gyxhVDNNUmHvcQyZBO-VPHAAfh3_kcB7WY8LTlQycb2LAWsBfKXE_AyE",
    //   "LinkBild_": "DS_A_26-03-19",
    //   "Bildunterschriften_": "Junge Angeh�rige der Waffen-SS werden im Norden Frankreichs von den Amerikanern gefangen genommen (Anfang September 1944). (Bild: Imago)"
    // },
    {
      "Profil_": "DS",
      "Position_": "B",
      "Datum_": "26_03_19",
      "Uhrzeit_": "17:09",
      "Thema_": "Gesundheit\nImpfung\nDeutschland\nMasern",
      "GesinnungX_": "Mitte",
      "GesinnungY_": "Liberal",
      "Verl�sslichkeit_": "Analytisch",
      "Art_": "Zeitung",
      "Aufbau_": "Post-Artikel",
      "Medium_": "Text-Bild",
      "Bodytext_": "*pn*Tagesspiegel*/pn*\n\n*pd*24-03-19*/pd*\n\n*pb*Nach H�ufung von Masern-Erkrankungen will die Gro�e Koalition nun reagieren.*/pb*\n\n*an*Der Tagesspiegel*/an*\n\n*ad*24-03-19*/ad*\n\n*aa*Unbekannt*/aa*\n\n*at*Bundesregierung pr�ft Impfpflicht f�r Kinder*/at*\n\n*al*Die gro�e Koalition will auf eine neue Zunahme der Masern reagieren: Gesundheitsminister Spahn und SPD-Politiker Lauterbach verhandeln �ber eine Impfpflicht.*/al*\n\n*ab*Die gro�e Koalition pr�ft eine bundesweite�Masern-Impfpflicht f�r Kinder. SPD-Gesundheitsexperte Karl Lauterbach sagte, er sei mit Bundesgesundheitsminister Jens Spahn (CDU) im Gespr�ch dar�ber und \"zuversichtlich, dass wir demn�chst einen entsprechenden Vorschlag vorlegen k�nnen\". Lauterbach betonte gegen�ber dem Redaktionsnetzwerk Deutschland, seine Partei trete innerhalb der Koalition f�r eine Impfpflicht f�r Kinder ein, die sich auf Masern begrenzen solle.\nSpahn hatte schon vor seiner Zeit als Gesundheitsminister f�r verpflichtende Masern-Impfungen f�r Kinder stark gemacht. Anlass f�r die erneute Debatte ist eine�verst�rkte H�ufung von Masern-F�llen unter anderem im nieders�chsischen Hildesheim.\nAngesichts dieses Ausbruchs hatte sich die Deutsche Gesellschaft f�r Kinder- und Jugendmedizin (DGKJ) zuletzt erneut f�r eine Impfpflicht gegen Masern ausgesprochen. Masernerkrankungen seien extrem ansteckend und potenziell t�dlich. Je besser die Durchimpfungsrate sei, desto sicherer sei das Leben gerade f�r die Kleinsten, erkl�rte die Fachgesellschaft.\nDie Liberalen machen sich auch f�r die Impfpflicht stark. \"Die FDP spricht sich f�r eine gesetzliche Impfpflicht f�r Kinder bis 14 Jahre aus\", sagte der stellvertretende Vorsitzende der FDP-Bundestagsfraktion, Michael Theurer, dem RND. \"Seine Kinder nicht impfen zu lassen, ist verantwortungslos gegen�ber dem Wohl des eigenen Kindes und auch gegen�ber Menschen, die aus gesundheitlichen Gr�nden nicht selbst geimpft werden k�nnen.\"\nBundesgesundheitsminister Spahn m�sse die Menschen dar�ber offensiv aufkl�ren und den Zugang zu Impfungen erleichtern, forderte der FDP-Fraktionsvize. So k�nnten Impfungen auch in Schulen und Kitas angeboten werden, damit diese nicht so oft vergessen werden. \"Impfzur�ckhaltung ist problematisch\", sagte Theurer, deshalb sei als Ultima Ratio eine Impfpflicht n�tig.*/ab*\n\n*au*Keine harmlose Kinderkrankheit*/au*\n\n*ab*Masern sind keine harmlose Kinderkrankheit. Neben der akuten Erkrankung kann es als Sp�tfolge zur sogenannten SSPE kommen, einer meist t�dlichen Entz�ndung des Gehirns. Besonders gef�hrdet sind Kinder im ersten Lebensjahr, die noch zu jung f�r eine Masern-Mumps-R�teln-Impfung sind.\nAuch internationale Organisationen warnen massiv vor einer alarmierenden Zunahme von Masernf�llen: Weltweit h�tten im vergangenen Jahr 98 L�nder ein st�rkeres Auftreten der Virusinfektion registriert als im Vorjahr,�hei�t es in einem aktuellen Bericht des UN-Kinderhilfswerks Unicef.*/ab*",
      "LinkText_": "https://www.tagesspiegel.de/politik/nach-haeufung-von-masern-erkrankungen-bundesregierung-prueft-impfpflicht-fuer-kinder/24139722.html?fbclid=IwAR3-v1EUcuLGbzun2UDFisMIL3mahXwoxzgiDAr3O-FIP1ti59mv1kRVPFU",
      "LinkBild_": "DS_B_26-03-19",
      "Bildunterschriften_": "Bisher sind Impfungen nicht verpflichtend, Beh�rden und �rzte raten aber dringend dazu.FOTO: KAY NIETFELD/DPA"
    },
    {
      "Profil_": "DS",
      "Position_": "C",
      "Datum_": "26_03_2019",
      "Uhrzeit_": "17:39",
      "Thema_": "Wahlen\nZ�rich\nSchweiz\nKantonsrat\nGLP\nGr�ne",
      "GesinnungX_": "Mitte",
      "GesinnungY_": "Mitte",
      "Verl�sslichkeit_": "Komplex",
      "Art_": "Zeitung",
      "Aufbau_": "Post-Artikel",
      "Medium_": "Text-Bild",
      "Bodytext_": "*pn*NZZ Neue Z�rcher Zeitung*pn*\n\n*pd*25-03-19*/pd*\n\n*pb*Mit der b�rgerlichen Mehrheit im Z�rcher Kantonsrat ist es vorbei. GLP und Gr�ne jubilieren.\n\nDas ist eine spannende Ausgangslage auch f�r die nationalen Wahlen:*/pb*\n\n*an*Neue Z�rcher Zeitung*/an*\n\n*ad*25-03-19*/pd*\n\n*aa*Jan Hudec*/aa*\n\n*at*Die B�rgerlichen erleben bei den Z�rcher Wahlen ihr gr�nes Wunder*/at*\n\n*al*Mit der b�rgerlichen Mehrheit im Z�rcher Kantonsrat ist es vorbei. GLP und Gr�ne jubilieren. Eine spannende Ausgangslage auch f�r die nationalen Wahlen.*/al*\n\n*ab*Es war fast wie auf einer Safari � und das mitten in der Stadt Z�rich. Als die Fotografen und Journalisten am Sonntagnachmittag in der Ferne Martin Neukom erblicken, bricht helle Aufregung aus. Sekunden sp�ter ist der Z�rcher Neo-Regierungsrat umringt von Kameras und Mikrofonen. Noch vor einigen Monaten kannten den unscheinbaren 32-j�hrigen Kantonsrat der Gr�nen nur Polit-Insider. Am Sonntag wurde er zum Star. Er verk�rpert wie kein anderer die Sensation, die sich bei den Z�rcher Wahlen ereignet hat. Befl�gelt von den Klimademonstrationen der letzten Monate konnten die Gr�nen und die Gr�nliberalen ihre W�hleranteile im Kantonsrat um je rund 5 Prozentpunkte steigern und je 9 Sitze dazugewinnen. Wohl noch �berraschender ist, wie es Neukom schaffte, auf Kosten der FDP in den Z�rcher Regierungsrat einzuziehen.\nDas ist die zweite Geschichte, welche die Z�rcher Wahlen geschrieben haben. Es ist die Geschichte einer brutalen Niederlage f�r die B�rgerlichen. Da w�re einmal die FDP. Zum ersten Mal �berhaupt wird sie nicht mehr mit mindestens zwei Sitzen im Z�rcher Regierungsrat vertreten sein. Ihr Kandidat Thomas Vogel verpasste es, den Sitz des scheidenden Gesundheitsdirektors Thomas Heiniger zu verteidigen. FDP-Pr�sident Hans-Jakob Boesch sprach von einer dramatischen Niederlage. Vogel nahm er jedoch in Schutz. Er sei ein starker Kandidat gewesen, der sich im Wahlkampf voll engagiert habe. Die Ursache f�r den Sitzverlust ortete er vor allem in der politischen Grosswetterlage. �Den Effekt der gr�nen Welle darf man nicht untersch�tzen�, meinte Boesch.\nDieser Welle hatte das b�rgerliche B�ndnis aus SVP, FDP und CVP wenig entgegenzustellen. Der Tenor der doch etwas schlichten Kampagne lautete: Dem Kanton geht es gut, und das liegt daran, dass er b�rgerlich regiert ist. Boesch r�umte ein, dass man in Sachen Klimapolitik ein Defizit habe, die FDP sei aber daran, hier aufzuholen. Ohnehin waren es auch nicht die Liberalen, die am Wahlsonntag am h�rtesten getroffen wurden. Die BDP schaffte es nicht �ber die 5-Prozent-H�rde und ist damit nicht mehr im Kantonsrat vertreten. Deren sichtlich entt�uschter Fraktionspr�sident Marcel Lenggenhager meinte: �Ich bin �berzeugt, die BDP wird dem Kanton Z�rich fehlen.� Doch er gab sich k�mpferisch. �In vier Jahren stehen wir hoffentlich wieder da.� Und die Nationalratswahlen seien die n�chste Gelegenheit f�r die BDP, sich zu zeigen.*/ab*\n\n*au*Herber Verlust f�r die SVP*/au*\n*ab*Die ganz grosse Wahlverliererin ist die SVP, die zum ersten Mal seit Jahrzehnten einen derart drastischen R�ckschlag einstecken musste: Sie hat �ber 5 Prozentpunkte W�hleranteil eingeb�sst � sie liegt nun noch bei 24,5 Prozent � und hat 9 ihrer 54 Sitze verloren. Der Parteipr�sident der SVP Konrad Langhart meinte, er habe zwar mit Verlusten gerechnet, aber nicht in diesem Ausmass. �Das gr�ne Lager hat besser mobilisieren k�nnen�, sagte er. �Das m�ssen wir akzeptieren.� Momentan gebe es aber einen gesamtschweizerischen Trend, der nicht f�r die SVP spreche. Er sei nach wie vor davon �berzeugt, dass die Kernthemen der SVP wie das Verh�ltnis zur EU oder die Migration und das damit zusammenh�ngende Bev�lkerungswachstum wichtig bleiben w�rden.\nDie SVP konnte sich immerhin damit tr�sten, dass sie mit Nationalr�tin Natalie Rickli den zweiten Sitz der Partei im Regierungsrat verteidigen konnte. Allerdings reichte es der national bekannten Politikerin nur auf den letzten Platz der sieben gew�hlten Regierungsr�te. Neukom klassierte sich einen Rang vor ihr.\nRickli gab sich mit dem Resultat dennoch zufrieden. Sie selbst sei immer davon ausgegangen, dass es knapp werde. M�glicherweise habe es sie Stimmen gekostet, dass sie sich nicht verbogen habe im Wahlkampf. Aber: �Mir war es wichtig, mir selber treu zu bleiben.� Es sei jedoch schade, dass Thomas Vogel nicht gew�hlt worden sei. �Ich h�tte gerne mit ihm zusammengearbeitet�, sagte Rickli. Wichtig sei, dass der Regierungsrat weiterhin b�rgerlich dominiert bleibe. Dies sei mit einer 4-zu-3-Mehrheit gew�hrleistet. Die bisherigen Regierungsr�te Ernst Stocker (svp.), Carmen Walker Sp�h (fdp.), Silvia Steiner (cvp.), Mario Fehr und Jacqueline Fehr (beide SP) wurden im Amt best�tigt.*ab*\n\n*au*Neue Mehrheiten im Parlament*/au*\n*ab*Im Kantonsrat ist die b�rgerliche Mehrheit dagegen pass�. Die letzten vier Jahre konnten SVP, FDP und CVP gemeinsam die Politik im Z�rcher Kantonsrat bestimmen. Im neu zusammengesetzten Parlament verf�gt das rot-gr�ne Lager zusammen mit der EVP und der GLP �ber eine Mehrheit. Das d�rfte sich zwar in der Sozial- und Finanzpolitik nicht allzu stark auswirken, da in diesen Fragen die GLP in der Regel mit den B�rgerlichen stimmt. In Umwelt-, Energie- und Verkehrsfragen d�rfte k�nftig hingegen ein anderer Wind wehen.\nFDP-Pr�sident Boesch ist denn auch gespannt, wie sich die GLP positionieren wird: �Steht das L in ihrem Namen f�r links oder f�r liberal?� Corina Gredig, Co-Pr�sidentin der Gr�nliberalen, meinte dazu, dass ihre Partei in Zukunft vermehrt die Rolle der Br�ckenbauerin wahrnehmen werde. In �kologischen Fragen will die GLP freilich Akzente setzen. �Es ist sicher so, dass in den vergangenen vier Jahren im Z�rcher Kantonsrat in umweltpolitischer Hinsicht sehr wenig geschehen ist�, sagte Gredig. Das Wahlergebnis sei auch eine Konsequenz daraus. �Es w�re nicht so deutlich zu unseren Gunsten ausgefallen, wenn es bei diesen Themen im Kanton Z�rich mehr vorw�rtsgegangen w�re.�*/ab*\n\n*au*Vorbote f�r nationale Wahlen*/au*\n*ab*Mit dem Fokus auf den gr�nen Parteien blieb die SP f�r einmal im Schatten. Ihre Sitze in der Regierung waren ungef�hrdet, im Kantonsrat haben die Sozialdemokraten jedoch einen Sitz verloren. Am W�hleranteil �nderte sich allerdings nicht viel, dieser bewegt sich seit einiger Zeit knapp unter 20 Prozent. Entt�uscht sei er nicht, sagte Co-Pr�sident Andreas Daur� zum Wahlergebnis. Insgesamt sei es ein guter Sonntag. Zwar setze sich die SP f�r den Klimaschutz ein, die derzeitige Situation sei aber schon den Parteien zugutegekommen, die das Gr�n im Namen tr�gen.\nUnd den Exponenten dieser Parteien war zum Feiern zumute, allen voran Martin Neukom: �Das ist ein extrem guter Tag f�r mich, f�r die Gr�nen und f�r alle, denen �kologische Themen am Herzen liegen�, sagte er. Das Wahlergebnis sei eine klare Botschaft der Bev�lkerung, dass sie eine Politik wolle, die sich st�rker an der �kologie orientiere. �Die parteipolitische Landschaft hat sich grundlegend ver�ndert, nicht nur in den St�dten, auch auf dem Land.�\nDie Z�rcher Wahlen sind jeweils auch ein guter Stimmungstest f�r die nationalen Wahlen, die im Herbst anstehen. Die b�rgerlichen Parteien werden sich ein paar Gedanken machen m�ssen.*/ab*",
      "LinkText_": "https://www.nzz.ch/zuerich/zuercher-wahlen-buergerliche-erleben-ihr-gruenes-wunder-ld.1469739?fbclid=IwAR1aTK12I5zxOslg0kOv3qvJ-4tsvf8c1UqYBSxvEnZRL1HSnp_tXlvipMg",
      "LinkBild_": "DS_C_26-03-19",
      "Bildunterschriften_": "Der neue Z�rcher Regierungsrat mit (v.l.n.r.) Jacqueline Fehr (sp.), Martin Neukom (gp.), Natalie Rickli (svp.), Mario Fehr (sp.), Silvia Steiner (cvp.), Ernst Stocker (svp.) und Carmen Walker Sp�h (fdp.). (Bild: Christoph Ruckstuhl / NZZ)"
    }
];

var doc = app.documents.item(0);
var page = doc.pages.item(0);
var pageWidth = page.bounds[3] -  page.bounds[1];
var pageHeight = page.bounds[2] -  page.bounds[0];
var allGroups = [];
var lastPage = 0;
var wholeLength = 0;

// for (var i = 0; i < 1; i++) {
for (var i = 0; i < data.length; i++) {
    var newGroup = addGroup(i);
    allGroups.push(newGroup);

    wholeLength += getElement(newGroup).height;


    if (allGroups[i-1]) {

        var marginTop = 4;

        positionElement(newGroup, 0, getElement(allGroups[i-1]).y2 + marginTop, 0, 0);

        if(wholeLength >= pageHeight * (lastPage + 1) + marginTop) {
            doc.pages.add();
            lastPage ++;
            newGroup.move(doc.pages[lastPage])
        }
        
    }

    // doc.pages.add()
    // lastPage ++;

}


// addGroup(0);


function addGroup(index) {

    var itemsToGroup = new Array();  
    var id = '#' + index;

    // ===============
    // Profil
    // ===============

    var tb_profil = createTextbox('tb_profil', id, 'PROFIL ' + data[index].Profil_, itemsToGroup);
    tb_profil.paragraphs[0].pointSize = 18;
    positionElement(tb_profil, 0, 0, 0, 0);
    setDimensions(tb_profil, pageWidth/2, null, 0, 0);

    // ===============
    // Position
    // ===============

    var tb_position = createTextbox('tb_position', id, 'POSITION  ' + data[index].Position_, itemsToGroup);
    tb_position.paragraphs[0].pointSize = 18;
    positionElement(tb_position, pageWidth / 2, 0, 0, 0);
    setDimensions(tb_position, pageWidth/2, null, 0, 0);

    // ===============
    // Uhrzeit
    // ===============

    var tb_uhrzeit = createTextbox('tb_uhrzeit', id, data[index].Uhrzeit_, itemsToGroup);
    tb_uhrzeit.paragraphs[0].pointSize = 9;
    positionElement(tb_uhrzeit,  pageWidth/5 * 0, getElement(tb_profil).y2, 0, 0);
    setDimensions(tb_uhrzeit, pageWidth/5, null, 0, 0);

    // ===============
    // Aufbau
    // ===============

    var tb_aufbau = createTextbox('tb_aufbau', id, data[index].Aufbau_, itemsToGroup);
    positionElement(tb_aufbau, pageWidth/5 * 1, getElement(tb_profil).y2, 0, 0);
    setDimensions(tb_aufbau, pageWidth/5, null, 0, 0);

    // ===============
    // Medium
    // ===============

    var tb_medium = createTextbox('tb_medium', id, data[index].Medium_, itemsToGroup);
    positionElement(tb_medium, pageWidth/5 * 2, getElement(tb_profil).y2, 0, 0);
    setDimensions(tb_medium, pageWidth/5, null, 0, 0);

    // ===============
    // Art
    // ===============

    var tb_art = createTextbox('tb_art', id, data[index].Art_, itemsToGroup);
    positionElement(tb_art, pageWidth/5 * 3, getElement(tb_profil).y2, 0, 0);
    setDimensions(tb_art, pageWidth/5, null, 0, 0);

    // ===============
    // Datum
    // ===============

    // var tb_datum = page.textFrames.add();
    // tb_datum.name = 'element_' + id + '_textbox_datum' 
    // tb_datum.contents = data[index].Datum_;
    // positionElement(tb_datum, 0, getElement(tb_uhrzeit).y2, 0, 0);
    // setDimensions(tb_datum, pageWidth/3, null);
    // itemsToGroup.push(tb_datum);

    // ===============
    // Body Text
    // ===============

    var fullText = data[index].Bodytext_;
    var postName = getText(fullText, 'pn');
    var postDatum = getText(fullText, 'pd');
    var postBodyText = getText(fullText, 'pb');
    var repostName = getText(fullText, 'rn');
    var repostDatum = getText(fullText, 'rd');
    var repostBodyText = getText(fullText, 'rb');
    var artikelName = getText(fullText, 'an');
    var artikelDatum = getText(fullText, 'ad');
    var artikelAutor = getText(fullText, 'aa');
    var artikelTitel = getText(fullText, 'at');
    var artikelLead = getText(fullText, 'al');
    var artikelUntertitel = getText(fullText, 'au');
    var artikelBodytext = getText(fullText, 'ab');


    var tb_text_postDatum = createTextbox('tb_text_postDatum', id, postDatum, itemsToGroup);
    positionElement(tb_text_postDatum, 0, getElement(tb_art).y2, 0, 0);
    setDimensions(tb_text_postDatum, pageWidth/3, null, 0, 0);

    var tb_text_postName = createTextbox('tb_text_postName', id, postName, itemsToGroup);
    positionElement(tb_text_postName, pageWidth/3 * 1, getElement(tb_art).y2, 0, 0);
    setDimensions(tb_text_postName, pageWidth/3, null, 0, 0);

    var tb_text_postBodyText = createTextbox('tb_text_postBodyText', id, postBodyText, itemsToGroup);
    tb_text_postBodyText.paragraphs[0].pointSize = 24;
    tb_text_postBodyText.paragraphs[0].appliedFont = app.fonts.item("Neue Haas Unica Pro");
    tb_text_postBodyText.paragraphs[0].fontStyle = "Black";
    positionElement(tb_text_postBodyText, 0, getElement(tb_text_postName).y2, 0, 0);
    setDimensions(tb_text_postBodyText, pageWidth, null, 0, 2);

    var tb_text_artikelDatum = createTextbox('tb_text_artikelDatum', id, artikelDatum, itemsToGroup);
    positionElement(tb_text_artikelDatum, pageWidth/5, getElement(tb_text_postBodyText).y2, 0, 0);
    setDimensions(tb_text_artikelDatum, pageWidth/5, null, 0, 0);

    var tb_text_artikelBodytext = createTextbox('tb_text_artikelBodytext', id, artikelBodytext, itemsToGroup);
    positionElement(tb_text_artikelBodytext, pageWidth/5 * 2, getElement(tb_text_postBodyText).y2, 0, 0);
    setDimensions(tb_text_artikelBodytext, pageWidth/5*3, null, 0, 0);


    // var tb_bodyText_postName = page.textFrames.add();
    // tb_bodyText_postName.name = 'element_' + id + '_textbox_bodyText_postName' 
    // tb_bodyText_postName.contents = postName;
    // positionElement(tb_bodyText_postName, pageWidth/3 * 1, getElement(tb_art).y2, 0, 0);
    // setDimensions(tb_bodyText_postName, pageWidth/3, null);
    // itemsToGroup.push(tb_bodyText_postName);

    // var tb_bodyText = page.textFrames.add();
    // tb_bodyText.name = 'element_' + id + '_textbox_bodyText' 
    // tb_bodyText.contents = postName;
    // positionElement(tb_bodyText, 0, getElement(tb_datum).y2, 0, 0);
    // setDimensions(tb_bodyText, pageWidth, null);
    // itemsToGroup.push(tb_bodyText);


    // var tb_thema = page.textFrames.add();
    // tb_thema.name = 'element_' + id + '_textbox_thema' 
    // tb_thema.contents = data[index].Thema_;
    // positionElement(tb_thema, pageWidth/5 * 1, getElement(tb_profil).height, 0, 0);
    // setDimensions(tb_thema, pageWidth/5, null);
    // itemsToGroup.push(tb_thema);

    // var tb_gesinnung = page.textFrames.add();
    // tb_gesinnung.contents = data[index].Gesinnung_;

    // var tb_gesinnung = page.textFrames.add();
    // tb_gesinnung.name = 'element_' + id + '_textbox_gesinnung' 
    // tb_gesinnung.contents = data[index].Gesinnung_;
    // positionElement(tb_gesinnung, pageWidth/5 * 1, getElement(tb_profil).height, 0, 0);
    // setDimensions(tb_gesinnung, pageWidth/5, null);
    // itemsToGroup.push(tb_gesinnung);

    // var tb_verlässlichkeit = page.textFrames.add();
    // tb_verlässlichkeit.contents = data[index].tb_verlässlichkeit;

    // var tb_verlasslichkeit = page.textFrames.add();
    // tb_verlasslichkeit.name = 'element_' + id + '_textbox_verlasslichkeit' 
    // tb_verlasslichkeit.contents = data[index].Verlässlichkeit_;
    // positionElement(tb_verlasslichkeit, pageWidth/5 * 1, getElement(tb_profil).height, 0, 0);
    // setDimensions(tb_verlasslichkeit, pageWidth/5, null);
    // itemsToGroup.push(tb_verlasslichkeit);

    // var tb_art = page.textFrames.add();
    // tb_art.contents = data[index].Art_;

    // var tb_medium = page.textFrames.add();
    // tb_medium.contents = data[index].Medium_;

    // var tb_bodyText = page.textFrames.add();
    // tb_bodyText.contents = data[index].Bodytext_;

    // var tb_linkText = page.textFrames.add();
    // tb_linkText.contents = data[index].LinkText_;

    // var tb_linkBild = page.textFrames.add();
    // tb_linkBild.contents = data[index].LinkBild_;

    // var tb_bildUnterschriften = page.textFrames.add();
    // tb_bildUnterschriften.contents = data[index].Bildunterschriften_;


    var myGroup = app.documents[0].groups.add(itemsToGroup);  
    myGroup.name = 'element_' + id; 

    return myGroup;
}

function createTextbox(element, id, content, array) {

    var item = doc.pages.item(lastPage).textFrames.add();
    item.contents = content || 'unknown';
    item.recompose();
    item.fit(FitOptions.frameToContent);
    item.name = 'element_' + id + '_textbox_' * element;
    array.push(item);

    var text = item.paragraphs[0];
    text.appliedFont = app.fonts.item("Nimbus Roman Mono M");
    text.fontStyle = "Regular";

    return item;
}


function positionElement(element, x, y, marginLeft, marginTop) {
    // element.recompose();
    element.fit(FitOptions.frameToContent);
    
    var elementWidth = element.geometricBounds[3] -  element.geometricBounds[1];
    var elementHeight = element.geometricBounds[2] -  element.geometricBounds[0];

    element.geometricBounds = [y, x, marginTop + y + elementHeight, marginLeft + x + elementWidth];

}

function getElement(element) {

    var item = {
        x: element.geometricBounds[1],
        y: element.geometricBounds[0],
        x2: element.geometricBounds[3],
        y2: element.geometricBounds[2],
        width: element.geometricBounds[3] -  element.geometricBounds[1],
        height: nameHeight = element.geometricBounds[2] -  element.geometricBounds[0],
    }

    return item;
}

function setDimensions(element, width, height, spacingRight, spacingBottom) {

    var dimensions = element.geometricBounds;

    if (width) {
        element.geometricBounds = [dimensions[0], dimensions[1], dimensions[2], dimensions[1] + width];
    }

    dimensions = element.geometricBounds;

    if (spacingRight) {
        element.geometricBounds = [dimensions[0], dimensions[1], dimensions[2], dimensions[1] + spacingRight];
    }

    element.fit(FitOptions.frameToContent);
    dimensions = element.geometricBounds;

    if (height) {
        element.geometricBounds = [dimensions[0], dimensions[1], dimensions[2] + height, dimensions[3] ];
    }

    dimensions = element.geometricBounds;


    if (spacingBottom) {
        element.geometricBounds = [dimensions[0], dimensions[1], dimensions[2] + spacingBottom, dimensions[3] ];
    }

}

function getText(fullText, type) {

    // var partial = fullText.split('*' + type + '*').pop().split("\n")[0] || 'unknown';
    var partial = fullText.split('*' + type + '*').pop().split('*/' + type + '*')[0] || 'unknown';
    return partial;
}
   
